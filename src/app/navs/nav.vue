<template lang="pug">
.nav-box
    .app-nav
        .app-nav-logo(v-if="isiframe === false")
            span.logo
            span.text MAPV
        .app-nav-btn(@click="addLayer" :class="nav==='layer'?'active':''") 新建图层
        Layers
        .app-nav-btn.map(@click="changeNav('map')" :class="nav==='map'?'active':''") 地图样式设置
        //- .app-nav-block(@click="changeNav('layer')" :class="nav==='layer'?'active':''") 图层
            .svg
                svg
                    path(d="M21 17.016v-14.016h-14.016v14.016h14.016zM21 0.984c1.078 0 2.016 0.938 2.016 2.016v14.016c0 1.078-0.938 1.969-2.016 1.969h-14.016c-1.078 0-1.969-0.891-1.969-1.969v-14.016c0-1.078 0.891-2.016 1.969-2.016h14.016zM3 5.016v15.984h15.984v2.016h-15.984c-1.078 0-2.016-0.938-2.016-2.016v-15.984h2.016zM15.938 10.313l3.563 4.688h-11.016l2.766-3.516 1.969 2.344z")
        //- .app-nav-block(@click="changeNav('data')" :class="nav==='data'?'active':''") 数据
            .svg
                svg
                    path(d="M6.984 12v2.016h-1.969v-2.016h1.969zM6.984 8.016v1.969h-1.969v-1.969h1.969zM18.984 12v2.016h-10.969v-2.016h10.969zM18.984 8.016v1.969h-10.969v-1.969h10.969zM21 17.016v-12h-18v12h18zM21 3c1.078 0 2.016 0.938 2.016 2.016l-0.047 12c0 1.078-0.891 1.969-1.969 1.969h-5.016v2.016h-7.969v-2.016h-5.016c-1.078 0-2.016-0.891-2.016-1.969v-12c0-1.078 0.938-2.016 2.016-2.016h18z")
        //- .app-nav-block(@click="changeNav('map')" :class="nav==='map'?'active':''") 地图
            .svg
                svg
                    path(d="M16.359 14.016h3.375c0.141-0.656 0.281-1.313 0.281-2.016s-0.141-1.359-0.281-2.016h-3.375c0.094 0.656 0.141 1.313 0.141 2.016s-0.047 1.359-0.141 2.016zM14.578 19.547c1.828-0.609 3.422-1.922 4.359-3.563h-2.953c-0.328 1.266-0.797 2.438-1.406 3.563zM14.344 14.016c0.094-0.656 0.141-1.313 0.141-2.016s-0.047-1.359-0.141-2.016h-4.688c-0.094 0.656-0.141 1.313-0.141 2.016s0.047 1.359 0.141 2.016h4.688zM12 19.969c0.844-1.219 1.5-2.531 1.922-3.984h-3.844c0.422 1.453 1.078 2.766 1.922 3.984zM8.016 8.016c0.328-1.266 0.797-2.438 1.406-3.563-1.828 0.609-3.422 1.922-4.359 3.563h2.953zM5.063 15.984c0.938 1.641 2.531 2.953 4.359 3.563-0.609-1.125-1.078-2.297-1.406-3.563h-2.953zM4.266 14.016h3.375c-0.094-0.656-0.141-1.313-0.141-2.016s0.047-1.359 0.141-2.016h-3.375c-0.141 0.656-0.281 1.313-0.281 2.016s0.141 1.359 0.281 2.016zM12 4.031c-0.844 1.219-1.5 2.531-1.922 3.984h3.844c-0.422-1.453-1.078-2.766-1.922-3.984zM18.938 8.016c-0.938-1.641-2.531-2.953-4.359-3.563 0.609 1.125 1.078 2.297 1.406 3.563h2.953zM12 2.016c5.531 0 9.984 4.453 9.984 9.984s-4.453 9.984-9.984 9.984-9.984-4.453-9.984-9.984 4.453-9.984 9.984-9.984z")
        //- .app-nav-version(@click="showinfo()")
            .svg
                svg(viewBox="0 0 1024 1024")
                    path(d="M961.645207 609.992404l-103.906262-75.973818c0.532687-7.116283 0.711111-13.87701 0.711111-20.460606 0-6.58101-0.178424-13.344323-0.711111-20.460606l104.083394-75.972526c11.209697-8.184242 16.012929-22.418101 12.276363-35.762424-10.317576-35.762424-24.374303-69.745778-41.810747-101.237656-6.76202-12.097939-20.461899-18.681535-33.983354-16.546909l-127.569454 19.927919c-9.075071-9.963313-18.682828-19.571071-28.823273-28.646142l19.926626-127.569454a33.043394 33.043394 0 0 0-16.546909-33.983354c-31.491879-17.436444-65.476525-31.491879-101.059232-41.633616-13.344323-3.736566-27.578182 1.06796-35.762424 12.276364l-75.972526 103.906262c-14.233859-0.889535-26.865778-0.889535-40.921212 0l-75.973818-103.906262c-8.184242-11.208404-22.418101-16.012929-35.761131-12.276364-35.585293 10.141737-69.567354 24.197172-101.060526 41.633616-12.276364 6.76202-18.858667 20.283475-16.72404 33.983354l19.926626 127.569454a367.884929 367.884929 0 0 0-28.823272 28.823273L125.590581 263.757576c-13.521455-2.134626-27.221333 4.447677-33.983354 16.546909-17.436444 31.313455-31.491879 65.296808-41.633616 101.059232-3.91499 13.344323 1.06796 27.578182 12.276364 35.762424l103.90497 75.972526c-0.532687 7.116283-0.711111 13.878303-0.711111 20.460606 0 6.583596 0.178424 13.344323 0.711111 20.460606l-103.90497 75.973818c-11.208404 8.184242-16.012929 22.418101-12.276364 35.761131 10.141737 35.762424 24.197172 69.744485 41.633616 101.237657 6.760727 12.099232 20.461899 18.681535 33.983354 16.546909l127.569455-19.926626a367.662545 367.662545 0 0 0 28.823272 28.823272l-19.926626 127.569455a33.042101 33.042101 0 0 0 16.546909 33.983353c31.313455 17.435152 65.296808 31.491879 101.059232 41.633617 13.344323 3.913697 27.578182-1.06796 35.762425-12.276364l75.972525-103.906263c14.055434 0.889535 26.865778 0.889535 40.922505 0l75.972525 104.083394c6.225455 8.539798 16.368485 13.522747 26.687354 13.522748 3.203879 0 6.22804-0.53398 9.252202-1.423515 35.762424-10.141737 69.745778-24.198465 101.059232-41.633617a33.044687 33.044687 0 0 0 16.546909-33.983353l-19.926626-127.569455c10.140444-8.896646 19.926626-18.504404 28.823273-28.644848l127.39103 19.748202c13.87701 2.134626 27.222626-4.446384 33.983354-16.546909 17.614869-31.491879 31.670303-65.475232 41.81204-101.237657 3.735273-13.344323-1.06796-27.578182-12.276364-35.762424z m-449.785535 105.647838c-111.543596 0-202.082263-90.53996-202.082263-202.082262s90.538667-202.08097 202.082263-202.08097c111.54101 0 202.08097 90.538667 202.08097 202.08097s-90.541253 202.082263-202.08097 202.082262z")
                    path(d="M511.526096 513.189495m-134.781414 0a134.781414 134.781414 0 1 0 269.562828 0 134.781414 134.781414 0 1 0-269.562828 0Z")
    md-dialog(:md-active.sync="shwoConfig")
        md-dialog-title MapV-Editor Beta v-{{version}}
        .md-dialog-concent 
            p 欢迎使用MapvV-Editor Beta，你现在看到的是我们的预览版MapV-Editor, 我们希望和各位一起让MapV变得更加强大。
            P 由于目前Editor还处于Beta版本，我们仅开放了部分功能，完整版会支持以下功能，敬请期待：
            P 1. 丰富的图层配置功能
            p 2. 强大的数据管理功能，我们支持任意格式的点线面数据文件导入
            p 3. 便捷的底图配置，你可以自定义底图样式，满足各种展示需求
            p 4. 输出功能，我们支持数据导出图片等格式，方便分享
            p 5. 本地化的软件体验，我们尽可能的优化我们的使用体验，使得MapV编辑器像本地应用一样方便快捷
            p 我们的QQ讨论群为: 321519841
            p 任何和MapV-Editor相关的问题和建议可以通过
                a(href="https://github.com/huiyan-fe/mapV-editor/issues") github的issue
                | 提交给我们
    //- md-snackbar(md-position="center" :md-active.sync="showSnackbar" )
        span mapv-Editor基于
            a(href="https://github.com/huiyan-fe/mapv" target="_blank") Mapv
            | 实现，目前处于beta版本，各功能可能并不完整，仅供评估学习使用。
        md-button(class="md-primary" @click="showSnackbar = false") 关闭
</template>

<script>
import { Action, Store } from 'marine';
import Layers from '../layers/layers.vue';
const version = require('../../../package.json').version;

export default {
    data: function () {
        return {
            // duration: 4000,
            // showSnackbar: true,
            nav: null,
            shwoConfig: false,
            version,
            isiframe: false
        }
    },
    components: {
      Layers
    },
    computed: {
    },
    methods: {
        addLayer: function() {
            this.changeNav('layer');
            Action.home.emit('addLayer');
        },
        changeNav: function (data) {
            if (data !== this.nav) {
                // close layer-console active
                if (this.nav && data !== 'layer') {
                    Action.home.emit('closeLayer');
                }
                this.nav = data;
                Action.home.emit('changeNav', data);
            }
        },
        showinfo: function () {
            this.shwoConfig = true;
        }
    },
    mounted: function () {
        // setTimeout(() => {
        //     this.showSnackbar = false;
        // }, this.duration);
        
        let search = location.search.substr(1);
        if (search.length > 0) {
            search = search.split('&');
            for (var i = 0; i < search.length; i++) {
                search[i] = search[i].split('=');
                if (search[i][0] === 'isiframe') {
                    this.isiframe = true;
                    break;
                }
            }
        }

        Store.on('home.importData', (data) => {
            console.log(this.nav)
            if (this.nav !== 'layer') {
                this.nav = 'layer';
                Action.home.emit('changeNav', 'layer');
            }
        });
        Store.on("home.changeNav", StoreData => {
            this.nav = StoreData.data;
        });
    }
}
</script>

<style lang="scss">
.md-dialog {
  z-index: 2000;
}
.md-overlay {
  z-index: 1900;
}
.md-dialog-concent {
  padding: 0 20px 20px 20px;
}
.app-nav {
  position: absolute;
  top: 0;
  left: 0;
  width: 220px;
  bottom: 0;
  background: #222;
  color: #b9b9b9;
  padding-top: 20px;
  .app-nav-logo {
    height: 40px;
    text-align: center;
    margin-bottom: 20px;
    .logo {
      width: 101px;
      height: 34px;
      margin: 0;
      background: url(./logo.png) no-repeat center;
      display: inline-block;
      background-size: contain;
    }
    .text {
      height: 18px;
      line-height: 18px;
      font-weight: 500;
      margin-left: 10px;
      border-left: 1px solid #ccc;
      text-indent: 9px;
      display: inline-block;
      font-size: 16px;
      color: #fff;
      vertical-align: super;
    }
  }
  .app-nav-btn {
    cursor: pointer;
    display: flex;
    -webkit-box-pack: center;
    justify-content: center;
    -webkit-box-align: center;
    align-items: center;
    border-radius: 100px;
    background-color: transparent;
    border:1px solid #eee;
    color: #fff;
    width: 180px;
    height: 30px;
    margin: 15px 20px;
    &:hover {
      background-color: rgba(245,83,61,0.7);
      border-color: rgba(245,83,61,0.7);
    }
    &.active {
      background-color: #f5533d;
      border-color: #f5533d;
    }
  }
  .app-nav-block {
    width: 60px;
    height: 60px;
    text-align: center;
    line-height: 60px;
    font-size: 14px;
    cursor: pointer;
    position: relative;
    &:hover {
      .svg {
        left: -100px;
      }
    }
    background: #323232;
    &.active .svg {
      background: #323232;
    }
    .svg {
      transition: all 0.3s ease;
      height: 59px;
      width: 60px;
      position: absolute;
      top: 0;
      left: 0;
      fill: #b9b9b9;
      background: #222;
      svg {
        width: 24px;
        height: 24px;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -14px;
      }
    }
  }
  .app-nav-version {
    width: 60px;
    height: 60px;
    position: absolute;
    left: 0;
    bottom: 0;
    fill: #b9b9b9;
    &:hover {
      fill: #fff;
      cursor: pointer;
    }
    svg {
      width: 24px;
      height: 24px;
      position: absolute;
      top: 50%;
      left: 50%;
      margin: -14px;
    }
  }
}
</style>
